<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="통계학: 파이썬을 이용한 분석">
<meta name="dcterms.date" content="2024-07-31">

<title>12장: 두 모집단의 비교 – StudyLog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5c49dcdaa1dd0040e71953adad602abc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">StudyLog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/SHINJIHAN"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://sinjihan71.tistory.com/"> 
<span class="menu-text"><img src="images/Tstory.png" style="width:15px;height:17px;"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">12장: 두 모집단의 비교</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>통계학: 파이썬을 이용한 분석 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 31, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#자료의-입력" id="toc-자료의-입력" class="nav-link active" data-scroll-target="#자료의-입력">1. 자료의 입력</a></li>
  <li><a href="#통계용어" id="toc-통계용어" class="nav-link" data-scroll-target="#통계용어">2. 통계용어</a></li>
  <li><a href="#두-개-의-독-립-표-본" id="toc-두-개-의-독-립-표-본" class="nav-link" data-scroll-target="#두-개-의-독-립-표-본">3. 두 개 의 독 립 표 본</a>
  <ul class="collapse">
  <li><a href="#모평균의-차에-대한-추론" id="toc-모평균의-차에-대한-추론" class="nav-link" data-scroll-target="#모평균의-차에-대한-추론">3-1. 모평균의 차에 대한 추론</a></li>
  <li><a href="#모평균의-차에-대한-추론-1" id="toc-모평균의-차에-대한-추론-1" class="nav-link" data-scroll-target="#모평균의-차에-대한-추론-1">3-2. 모평균의 차에 대한 추론</a></li>
  <li><a href="#모평균의-차에-대한-추론-2" id="toc-모평균의-차에-대한-추론-2" class="nav-link" data-scroll-target="#모평균의-차에-대한-추론-2">3-3. 모평균의 차에 대한 추론</a></li>
  </ul></li>
  <li><a href="#짝비교" id="toc-짝비교" class="nav-link" data-scroll-target="#짝비교">4. 짝비교</a></li>
  <li><a href="#두-모비율의-차에-대한-추론" id="toc-두-모비율의-차에-대한-추론" class="nav-link" data-scroll-target="#두-모비율의-차에-대한-추론">5. 두 모비율의 차에 대한 추론</a>
  <ul class="collapse">
  <li><a href="#두-모비율의-검정" id="toc-두-모비율의-검정" class="nav-link" data-scroll-target="#두-모비율의-검정">5-1. 두 모비율의 검정</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>두 모집단의 비교를 위한 추론과정은 자료를 어떻게 수집하느냐에 따라 추론 방법이 달라진다. 대표적인 두 종류의 자료수집과정에 따른 추론방법을 다루고자 한다.</p>
<section id="자료의-입력" class="level3">
<h3 class="anchored" data-anchor-id="자료의-입력">1. 자료의 입력</h3>
<div id="8f4ded3b" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 예제12: 산림자원의 현황을 파악하는데</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 인공위성에 설치된 특수한 스캐너를 이용하려 한다.</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 이 스캐너가 충분히 실제 지상의 상황을 반영하는가를 알아보기 위해서 </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># '숲이 있는 지역'과 '도시지역'을 지날 때의 스캐너의 수치를 비교하고자 한다. </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 지역에서 얻어진 스캐너 수치의 평균이 다르면 </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 도시와 숲을 구별하는 데 스캐너가 사용될 수가 있다고 한다. </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료로부터 평균 차의 95% 신뢰구간을 구하고, 스캐너의 사용이 가능한지를 판단하라. (p.387)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 교재 출처 최하단에 표시 ##</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 숲이 있는 지역을 지날 때의 스캐너 수치:</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">77</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">78</span>, <span class="dv">81</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">82</span>, <span class="dv">82</span>, <span class="dv">82</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>              <span class="dv">82</span>, <span class="dv">83</span>, <span class="dv">83</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">86</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>              <span class="dv">86</span>, <span class="dv">86</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">87</span>, <span class="dv">87</span>, <span class="dv">87</span>, <span class="dv">87</span>, <span class="dv">87</span>, <span class="dv">87</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>              <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">90</span>, <span class="dv">90</span>, </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>              <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, <span class="dv">91</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>              <span class="dv">93</span>, <span class="dv">93</span>, <span class="dv">93</span>, <span class="dv">93</span>, <span class="dv">93</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>              <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">95</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>              <span class="dv">95</span>, <span class="dv">95</span>, <span class="dv">95</span>, <span class="dv">96</span>, <span class="dv">96</span>, <span class="dv">96</span>, <span class="dv">96</span>, <span class="dv">96</span>, <span class="dv">96</span>, <span class="dv">97</span>, </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>              <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">97</span>, <span class="dv">98</span>, <span class="dv">99</span>, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>              <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>              <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">101</span>, <span class="dv">102</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>              <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">103</span>, <span class="dv">104</span>, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>              <span class="dv">104</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">107</span>]) </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 도시지역을 지날 때의 스캐너 수치:</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">71</span>, <span class="dv">72</span>, <span class="dv">73</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">77</span>, <span class="dv">78</span>, <span class="dv">79</span>, <span class="dv">79</span>, <span class="dv">79</span>, </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>              <span class="dv">79</span>, <span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">81</span>, <span class="dv">81</span>, <span class="dv">81</span>, <span class="dv">82</span>, <span class="dv">82</span>, <span class="dv">82</span>, </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>              <span class="dv">82</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">85</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>              <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">86</span>, <span class="dv">86</span>, <span class="dv">87</span>, <span class="dv">88</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">94</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="통계용어" class="level2">
<h2 class="anchored" data-anchor-id="통계용어">2. 통계용어</h2>
<p>비교 연구 시 자주 사용되는 통계용어.</p>
<p>실험단위 ( Experimental Unit ) : 실험의 대상. 반응값 ( Response ) : 실험 후 얻어지는 수치. 처리 ( Treatment ) : 비교하고자 하는 특성.</p>
<p>예제12를 위 통계용어로 다음과 같이 설명할 수 있다:</p>
<p>숲 지역 ⇨ 처리 1 , 도시 지역 ⇨ 처리 2 각각의 스캐너 측정값 ⇨ 실험단위</p>
<p>그 측정값의 수치 ⇨ 반응값</p>
</section>
<section id="두-개-의-독-립-표-본" class="level2">
<h2 class="anchored" data-anchor-id="두-개-의-독-립-표-본">3. 두 개 의 독 립 표 본</h2>
<p>독립인 두 개의 표본으로부터 두 모집단, 혹은 두 가지의 처리효과를 비교하는 통계추론의 방법. 다음은 두 모집단으로부터 추출된 표본과 그로부터 계산되는 통계량을 정리한 것이다: 두 모집단으로부터 추출된 표본.</p>
<p>위 표본으로부터 계산되는 통계량. 여기서 우리의 관심사는 두 모집단의 평균 반응값의 차이다.</p>
<section id="모평균의-차에-대한-추론" class="level3">
<h3 class="anchored" data-anchor-id="모평균의-차에-대한-추론">3-1. 모평균의 차에 대한 추론</h3>
<p>두 모평균의 차 ( μ 1 – μ 2 ) 에 대한 추론을 위해서는 두 표본평균의 차 ( x̄ – ȳ )를 이용한다. 두 표본의 크기 n 1, n 2 가 모두 큰 경우 ( 30 이상 )중심극한정리에 의해 두 표본평균은 근사적으로 정규분포를 따른다:</p>
<p>평균이 μ​ 1 ± μ 2​ 이고, 분산이 σ 12 ​+ σ 22 ​인 정규분포를 따른다:</p>
<p>이때, X 와 Y 는 서로 독립이다. 복호동순 : 식에서 부호를 2 개 이상 사용할 때, 부호를 앞에서부터 같은 순서로 적용하는 것. 따라서, 두 독립적인 정규분포 변수의 차를 표준화하면 표준정규분포를 따르게 된다: 위 분포를 바탕으로 ( μ 1 – μ 2 ) 에 대한 신뢰구간은 다음과 같다: 추정량 ± (z값) × (추정된 표준오차)</p>
<p>두 표본의 크기 n 1, n 2 가 모두 30 이상일 때, 가설 H 0 : μ 1 – μ 2 = δ 0 에 대한 검정통계량은 다음과 같다:</p>
<p>델타( Δ , δ: 그리스 알파벳의 네번째 글자)</p>
<p>검정통계량은 H 0 이 맞을 때 N ( 0 , 1 ) 을 따른다. 각 대립가설에 대하여 유의수준 α 를 갖는 기각역은 다음과 같다:</p>
</section>
<section id="모평균의-차에-대한-추론-1" class="level3">
<h3 class="anchored" data-anchor-id="모평균의-차에-대한-추론-1">3-2. 모평균의 차에 대한 추론</h3>
<p>표본의 크기가 작을 경우, 두 모집단에 대하여 정규분포와 표준편차에 대한 가정이 필요하다.</p>
<p>두 모집단이 모두 정규분포를 따른다. 두 모집단의 표준편차가 일치한다.</p>
<p>값이 ½보다 작거나 2보다 큰 경우, 위 가정이 적절하지 못한다고 판단한다. 대부분의 경우, σ 를 모르므로 이를 추정하여야 한다.</p>
<p>σ 에 대한 정보는 편차제곱합에 모두 들어 있다. 따라서 이 두 제곱합을 더하여 각각의 자유도의 합으로 나누어 σ 2 추정량으로 사용하게 된다.</p>
<p>이를 공통분산 σ 2 의 합동추정량 ( Pooled Variance ) 이라 한다:</p>
<p>위 식을 이용하여, ( μ 1 – μ 2 ) 에 대한 표준화된 확률변수는 다음과 같다:</p>
<p>자유도가 ( n ₁ + n ₂ – 2 )인 t 분포를 따른다.</p>
<p>위 분포를 바탕으로 ( μ 1 – μ 2 ) 에 대한 신뢰구간은 다음과 같다:</p>
<p>( μ ₁ – μ ₂ ) 에 대한 신뢰구간은 추정량 ± ( t 값 ) × ( 추정된 표준오차 )의 형식에 의해 정리된다.</p>
<p>두 모집단이 모두 정규분포를 따르고 두 모표준편차가 같은 때 가설 H 0 : μ 1 – μ 2 = δ 0 에 대한 검정통계량은 다음과 같다:</p>
<p>각 대립가설에 대하여 유의수준 α 를 갖는 기각역은 다음과 같다:</p>
</section>
<section id="모평균의-차에-대한-추론-2" class="level3">
<h3 class="anchored" data-anchor-id="모평균의-차에-대한-추론-2">3-3. 모평균의 차에 대한 추론</h3>
<p>표본의 크기가 작고, 두 모집단의 표준편차가 일치하지 않을 경우, 근사적으로 t 분포를 따르며, 자유도는 ( n 1 – 1 )과 ( n 2 – 1 ) 중 작은 값이다.</p>
<p>이 분포를 이용한 ( μ 1 – μ 2 ) 에 대한 추론방법은 다음과 같다:</p>
<p>모평균 차에 대한 100 ( 1 − α ) % 신뢰구간은 근사적으로 위 식과 같다.</p>
<p>신뢰구간의 경우, 그 구간이 넓어지는 경향이 있다. 따라서 실제 신뢰도는 100 ( 1 − α ) % 이상이 된다.</p>
<p>가설 H 0 : μ 1 – μ 2 = δ 0 에 대한 검정통계량은 다음과 같다:</p>
<p>검정의 경우, 기각역이 좁아지는 경향이 있다. 따라서 실제 유의수준이 α 이하가 되므로 귀무가설을 기각하지 못할 가능성이 높아진다.</p>
</section>
</section>
<section id="짝비교" class="level2">
<h2 class="anchored" data-anchor-id="짝비교">4. 짝비교</h2>
<p>Matched Pair Comparisons 실험 단위들이 비슷해야 한다는 점과 다양한 실험 단위들을 비교해야 한다는 점을 절충하는 접근법.</p>
<p>짝지워서 각각의 쌍으로 만드는 방법:</p>
<p>같은 쌍의 실험단위들은 서로 비슷해야 한다. 각 쌍 내에서 두 조건이 다르게 설정되어야 한다.</p>
<p>짝 비교를 시행할 때의 자료의 형태:</p>
<p>차의 표본평균과 분산은 다음과 같다:</p>
<p>X i 와 Y i 는 서로 독립이 아니다. 서로 높은 상관관계를 가질 경우, 짝비교의 효과는 크다. 즉, 전체적인 변화의 폭 ( 변동성 ) 을 줄여 처리효과를 알아내기 수월한 짝비교를 할 수 있다.</p>
<p>모평균 δ 에 대한 100 ( 1 − α ) % 신뢰구간은 다음과 같다:</p>
<p>귀무가설 H 0 : δ = δ 0 에 대한 검정통계량은 다음과 같다:</p>
<p>H ₀ 가 맞을 때 자유도가 ( n – 1 )인 t 분포를 따른다.</p>
<p>자료가 짝지워져 있는 경우,두 개의 처리를 어떻게 배정할 것인가가 전혀 문제되지 않는다. 자료가 짝지워져 있지 않은 경우, 여러 조건들이 확률적으로 같은 정도로 영향이 미치도록 해야 한다. (어느 한쪽의 처리에만 영향을 주지 않아야 한다.)이와 같이 무작위로 배정하는 것을 랜덤화 ( Randomization ) 라고 한다.</p>
</section>
<section id="두-모비율의-차에-대한-추론" class="level2">
<h2 class="anchored" data-anchor-id="두-모비율의-차에-대한-추론">5. 두 모비율의 차에 대한 추론</h2>
<p>두 모집단의 비율을 비교하는 추론하는 방법. 관심의 대상이 되는 어떤 특성의 모집단 1 의 비율을 p 1, 모집단 2 의 비율을 p 2 라고 할 때 두 모집단으로부터 크기가 n 1, n 2 인 표본을 추출하여 각각 특성이 A 인 것과 A 가 아닌 것으로 분류하였다고 가정한다.</p>
<p>이때 A 를 ’ 성공 ‘, A 가 아닌 것을’ 실패 ’ 라고 하고 두 표본의 성공의 개수를 각각 X, Y 표현한다.</p>
<p>두 모집단의 특성 A 의 비율을 각각 p 1, p 2 라고 하면 그 추정량은 각 표본으로부터 표본의 비율을 사용하게 된다:</p>
<p>두 모비율의 차 ( p ₁ – p ₂ ) 의 추정량은 ( p̂ ₁ – p̂ ₂ ) 이 된다. ( p 1 – p 2 ) 에 대한 추론을 하기 위해서는 ( p̂ 1 – p̂ 2 ) 의 분포를 알아야 한다.</p>
<p>표본의 크기 n 1, n 2 가 큰 경우, 아래 식이 근사적으로 성립한다:</p>
<p>아래 식도 표본이 서로 독립이므로 정규분포로 근사된다:</p>
<p>따라서 이를 표준화하면:</p>
<p>두 확률변수 간의 차이를 표준화하는 것이다.</p>
<p>위 식을 이용하여 ( p 1 – p 2 ) 에 대한 ( 1 − α ) % 신뢰구간은 다음과 같다:</p>
<p>( 추정량 ) ± ( z 값 ) × ( 표준오차 )의 형식에 의해 정리된다.</p>
<p>신뢰구간을 계산할 때, ( 제곱근 속의 ) 실제 모평균 차이 p 1, p 2 는 미지수이므로, 이를 표본 비율의 차이 p̂ 1, p̂ 2 로 대체하여 계산한다.</p>
<section id="두-모비율의-검정" class="level3">
<h3 class="anchored" data-anchor-id="두-모비율의-검정">5-1. 두 모비율의 검정</h3>
<p>표본의 크기가 클 때 두 모비율이 같은지를 검정하는 방법은 두 비율의 차이에 대한 검정을 통해 이루어진다.</p>
<p>귀무가설 H 0 : p = p 0 을 검정하기 위해 (​ p̂ 1 – p̂ 2 ) 을 이용하게 된다. 이 가설이 맞을 경우의 통계량 분포는 다음과 같다:</p>
<p>p 는 모비율이 같은 두 모집단의 공통비율이다.</p>
<p>통합된 두 표본으로부터 이를 추정하면:</p>
<p>위 과정을 바탕으로 검정통계량을 정리할 수 있다:</p>
<p>p̂ 는 귀무가설하에서의 공통비율 p 의 추정량이고, 검정통계량은 H 0 가 맞을 때 근사적으로 N ( 0, 1 ) 을 따른다.</p>
<p>각 대립가설에 대하여 유의수준 α 를 갖는 기각역은 다음과 같다:</p>
<p>예제 12의 ( 1 ) 추정량의 표준오차 ( se ) 를 계산하기 위해 두 변수의 요약통계량 ( s 12, s 22 ) 을 구하는 파이썬 함수를 사용할 수 있다.</p>
<div id="066b8248" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="op">=</span> np.var(x, ddof<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span><span class="bu">print</span>(var1) <span class="co"># x의 표본 분산 (자유도=1)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>var2 <span class="op">=</span> np.var(y, ddof<span class="op">=</span><span class="dv">1</span>)<span class="op">;</span><span class="bu">print</span>(var2) <span class="co"># y의 표본 분산 (자유도=1)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="op">=</span> <span class="bu">len</span>(x)<span class="op">;</span><span class="bu">print</span>(n1) <span class="co"># x의 데이터 수</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>n2 <span class="op">=</span> <span class="bu">len</span>(y)<span class="op">;</span><span class="bu">print</span>(n2) <span class="co"># y의 데이터 수</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> math.sqrt(var1 <span class="op">/</span> n1 <span class="op">+</span> var2 <span class="op">/</span> n2)<span class="op">;</span><span class="bu">print</span>(se) <span class="co"># 표준오차</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>48.06374040272343
24.789102564102567
118
40
1.0134334699544658</code></pre>
</div>
</div>
<p>표준오차 계산 ( 1.0134 )</p>
<p>예제 12의 ( 2 ) 모평균의 차 μ 1 – μ 2 에 대한 95% 신뢰구간을 구하라.</p>
<div id="13485ee9" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰수준 95%에 해당하는 z–값</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>z_alpha <span class="op">=</span> stats.norm.ppf(<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="dv">2</span>)<span class="op">;</span><span class="bu">print</span>(z_alpha)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>interval_z <span class="op">=</span> z_alpha <span class="op">*</span> se<span class="op">;</span> <span class="bu">print</span>(interval_z) <span class="co"># 신뢰구간 범위</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># x와 y의 평균을 계산</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>xbar1 <span class="op">=</span> np.mean(x)<span class="op">;</span> <span class="bu">print</span>(xbar1) </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>xbar2 <span class="op">=</span> np.mean(y)<span class="op">;</span> <span class="bu">print</span>(xbar2) </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 두 평균의 차이를 계산</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>diff <span class="op">=</span> xbar1 <span class="op">-</span> xbar2<span class="op">;</span> <span class="bu">print</span>(diff) </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰구간</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>CI_1 <span class="op">=</span> [diff <span class="op">-</span> interval_z, diff <span class="op">+</span> interval_z]<span class="op">;</span> <span class="bu">print</span>(CI_1)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">## 해석: 95%의 신뢰구간이 0을 포함하지 않으므로 (양측검정에서) </span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">## 유의수준 5%에서 두 수치가 같다는 귀무가설 (H₀ : μ1 = μ2) 을 기각할 수 있다.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.959963984540054
1.986293101838208
92.9322033898305
82.075
10.857203389830502
[np.float64(8.870910287992295), np.float64(12.84349649166871)]</code></pre>
</div>
</div>
<p>스캐너 자료 μ ₁ – μ ₂ 의 신뢰구간은 10.857 ± 1.986 이다.</p>
<p>예제 12의 ( 3 ) 두 모집단이 모두 정규분포를 따르고, 분산이 같다는 가정 하에서 합동분산추정량 및 추정량의 표준오차를 구하라.</p>
<div id="83629c8d" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 합쳐진 분산 계산</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>spooled <span class="op">=</span> ((n1 <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> var1 <span class="op">+</span> (n2 <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> var2) <span class="op">/</span> (n1 <span class="op">+</span> n2 <span class="op">-</span> <span class="dv">2</span>)<span class="op">;</span> <span class="bu">print</span>(spooled) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 합쳐진 표준 오차 계산</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>se_spooled <span class="op">=</span> math.sqrt(spooled) <span class="op">*</span> math.sqrt(<span class="dv">1</span> <span class="op">/</span> n1 <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> n2)<span class="op">;</span> <span class="bu">print</span>(se_spooled)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>42.24508094306821
1.1891745810061622</code></pre>
</div>
</div>
<p>합동추정량 ( 42.245 ) / 표준오차 ( 1.189 )</p>
<p>예제 12의 ( 4 ) 위 결과를 바탕으로 t – 분포의 백분위수 함수를 이용하여 95% 신뢰구간을 구하라.</p>
<div id="e10322e2" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰수준 95%에 해당하는 t–값</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>t_alpha <span class="op">=</span> stats.t.ppf(<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="dv">2</span>, n1 <span class="op">+</span> n2 <span class="op">-</span> <span class="dv">2</span>)<span class="op">;</span> <span class="bu">print</span>(t_alpha) </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰 구간의 범위</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>interval_t <span class="op">=</span> t_alpha <span class="op">*</span> se_spooled<span class="op">;</span> <span class="bu">print</span>(interval_t) </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰구간</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>CI_2 <span class="op">=</span> [diff <span class="op">-</span> interval_t, diff <span class="op">+</span> interval_t]<span class="op">;</span> <span class="bu">print</span>(CI_2)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 해석: (2)번의 정규분포를 이용한 신뢰구간보다 </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 오차범위 값인 interval_t가 더 크므로 신뢰구간이 더 넓어졌음을 알 수 있다.</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 이는 t–분포의 백분위수 값이 (정규분포의 백분위수 값보다) 더 크기 때문이다.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.9752875076954723
2.3489616943304696
[np.float64(8.508241695500033), np.float64(13.206165084160972)]</code></pre>
</div>
</div>
<p>신뢰구간은 10.857 ± 2.348 이다.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/shinjihan\.github\.io\/studylog");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>